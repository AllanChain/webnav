{"version":3,"sources":["webpack:///./src/dialogs/ImportDialog.vue?a6ca","webpack:///src/dialogs/ImportDialog.vue","webpack:///./src/dialogs/ImportDialog.vue?8cd6","webpack:///./src/dialogs/ImportDialog.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","$event","$emit","staticClass","model","value","callback","$$v","url","expression","$t","overwrite","$refs","file","click","_v","ref","importFromFile","importFromCloud","staticRenderFns","props","type","Boolean","default","data","computed","methods","e","target","reader","onload","readAsText","component","VBtn","VCard","VCardText","VCol","VContainer","VDialog","VIcon","VRow","VSwitch","VTextField"],"mappings":"iHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,WAAW,CAACE,MAAM,CAAC,OAAQ,EAAK,YAAY,SAASC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,MAAM,SAAS,MAAU,CAACL,EAAG,SAAS,CAACM,YAAY,gBAAgB,CAACN,EAAG,cAAc,CAACM,YAAY,QAAQ,CAACN,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,eAAe,CAACE,MAAM,CAAC,qBAAqB,UAAU,MAAQ,SAAS,MAAQ,WAAW,YAAc,kCAAkC,MAAQ,GAAG,SAAW,GAAG,eAAe,IAAIK,MAAM,CAACC,MAAOZ,EAAO,IAAEa,SAAS,SAAUC,GAAMd,EAAIe,IAAID,GAAKE,WAAW,UAAU,GAAGZ,EAAG,QAAQ,CAACA,EAAG,WAAW,CAACM,YAAY,YAAYJ,MAAM,CAAC,MAAQ,GAAG,eAAe,GAAG,MAAQN,EAAIiB,GAAG,qBAAqBN,MAAM,CAACC,MAAOZ,EAAa,UAAEa,SAAS,SAAUC,GAAMd,EAAIkB,UAAUJ,GAAKE,WAAW,gBAAgB,GAAGZ,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACM,YAAY,cAAcJ,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,GAAG,MAAQ,GAAG,MAAQ,oBAAoBC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAImB,MAAMC,KAAKC,WAAW,CAACjB,EAAG,SAAS,CAACJ,EAAIsB,GAAG,8BAA8B,GAAGlB,EAAG,QAAQ,CAACmB,IAAI,OAAOjB,MAAM,CAAC,KAAO,OAAO,OAAS,QAAQ,OAAS,IAAIC,GAAG,CAAC,OAASP,EAAIwB,mBAAmB,GAAGpB,EAAG,QAAQ,CAACM,YAAY,cAAcJ,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,GAAG,MAAQ,GAAG,MAAQ,SAASC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,MAAM,SAAS,MAAU,CAACL,EAAG,SAAS,CAACJ,EAAIsB,GAAG,sBAAsB,IAAI,GAAGlB,EAAG,QAAQ,CAACM,YAAY,cAAcJ,MAAM,CAAC,KAAO,MAAM,CAACF,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,GAAG,MAAQ,GAAG,MAAQ,SAASC,GAAG,CAAC,MAAQP,EAAIyB,kBAAkB,CAACrB,EAAG,SAAS,CAACJ,EAAIsB,GAAG,qBAAqB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACjmDI,EAAkB,G,kICyDtB,2DAEA,GACEC,MAAO,CACLf,MAAO,CACLgB,KAAMC,QACNC,SAAS,IAGbC,KAPF,WAQI,MAAO,CACLhB,IAAK,GACLG,WAAW,IAGfc,SAAU,OAAZ,OAAY,CAAZ,GACA,8CAEEC,QAAS,CACP,gBADJ,WACA,yLAEA,aAFA,cAEA,EAFA,gBAGA,SAHA,OAGA,EAHA,OAIA,qBAJA,qDAMA,yBACA,UACA,eARA,6DAYIT,eAbJ,SAaA,cACA,oBAEMU,EAAEC,OAAOvB,MAAQ,KACjB,IAAN,iBACMwB,EAAOC,OAAb,qKACA,kBADA,SAEA,iCAFA,iGAIMD,EAAOE,WAAWlB,IAEpB,gBAxBJ,SAwBA,8JACA,+BADA,uBAEA,oBAFA,6BAMA,mCACA,kDAGA,YAVA,wBAWA,sCAXA,SAYA,sCAZA,sCAcA,iCACA,2DAEA,yBACA,gCAlBA,UAoBA,8BApBA,QAuBA,yBACA,8CACA,iBAEA,oBA3BA,iDCpGk2B,I,yJCO91BmB,EAAY,eACd,EACAxC,EACA2B,GACA,EACA,KACA,KACA,MAIa,aAAAa,EAAiB,QAchC,IAAkBA,EAAW,CAACC,OAAA,KAAKC,QAAA,KAAMC,UAAA,OAAUC,OAAA,KAAKC,aAAA,KAAWC,UAAA,KAAQC,QAAA,KAAMC,OAAA,KAAKC,UAAA,KAAQC,aAAA","file":"js/import.4ceca2db.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-dialog',{attrs:{\"value\":true,\"max-width\":\"350px\"},on:{\"input\":function($event){return _vm.$emit('input', false)}}},[_c('v-card',{staticClass:\"elevation-12\"},[_c('v-card-text',{staticClass:\"pa-1\"},[_c('v-container',[_c('v-row',[_c('v-text-field',{attrs:{\"prepend-inner-icon\":\"mdi-web\",\"color\":\"purple\",\"label\":\"JSON URL\",\"placeholder\":\"https://example.cors/marks.json\",\"dense\":\"\",\"outlined\":\"\",\"hide-details\":\"\"},model:{value:(_vm.url),callback:function ($$v) {_vm.url=$$v},expression:\"url\"}})],1),_c('v-row',[_c('v-switch',{staticClass:\"ml-4 mt-0\",attrs:{\"dense\":\"\",\"hide-details\":\"\",\"label\":_vm.$t('import.overwrite')},model:{value:(_vm.overwrite),callback:function ($$v) {_vm.overwrite=$$v},expression:\"overwrite\"}})],1),_c('v-row',[_c('v-col',{staticClass:\"text-center\",attrs:{\"cols\":\"4\"}},[_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\",\"color\":\"indigo lighten-1\"},on:{\"click\":function($event){return _vm.$refs.file.click()}}},[_c('v-icon',[_vm._v(\"mdi-file-upload-outline\")])],1),_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"accept\":\".json\",\"hidden\":\"\"},on:{\"change\":_vm.importFromFile}})],1),_c('v-col',{staticClass:\"text-center\",attrs:{\"cols\":\"4\"}},[_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\",\"color\":\"amber\"},on:{\"click\":function($event){return _vm.$emit('input', false)}}},[_c('v-icon',[_vm._v(\"mdi-close-thick\")])],1)],1),_c('v-col',{staticClass:\"text-center\",attrs:{\"cols\":\"4\"}},[_c('v-btn',{attrs:{\"fab\":\"\",\"small\":\"\",\"color\":\"green\"},on:{\"click\":_vm.importFromCloud}},[_c('v-icon',[_vm._v(\"mdi-check-bold\")])],1)],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-dialog :value=\"true\" max-width=\"350px\" @input=\"$emit('input', false)\">\n    <v-card class=\"elevation-12\">\n      <v-card-text class=\"pa-1\">\n        <v-container>\n          <v-row>\n            <v-text-field\n              v-model=\"url\"\n              prepend-inner-icon=\"mdi-web\"\n              color=\"purple\"\n              label=\"JSON URL\"\n              placeholder=\"https://example.cors/marks.json\"\n              dense outlined hide-details\n            />\n          </v-row>\n          <v-row>\n            <v-switch\n              v-model=\"overwrite\"\n              dense\n              hide-details\n              class=\"ml-4 mt-0\"\n              :label=\"$t('import.overwrite')\"\n            />\n          </v-row>\n          <v-row>\n            <v-col cols=\"4\" class=\"text-center\">\n              <v-btn fab small color=\"indigo lighten-1\" @click=\"$refs.file.click()\">\n                <v-icon>mdi-file-upload-outline</v-icon>\n              </v-btn>\n              <input\n                ref=\"file\"\n                type=\"file\"\n                accept=\".json\"\n                hidden\n                @change=\"importFromFile\"\n              >\n            </v-col>\n            <v-col cols=\"4\" class=\"text-center\">\n              <v-btn fab small color=\"amber\" @click=\"$emit('input', false)\">\n                <v-icon>mdi-close-thick</v-icon>\n              </v-btn>\n            </v-col>\n            <v-col cols=\"4\" class=\"text-center\">\n              <v-btn fab small color=\"green\" @click=\"importFromCloud\">\n                <v-icon>mdi-check-bold</v-icon>\n              </v-btn>\n            </v-col>\n          </v-row>\n        </v-container>\n      </v-card-text>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport validate from '@/validator'\n\nconst bookmarkMatch = (t, m) => t.url === m.url && t.search === m.search\n\nexport default {\n  props: {\n    value: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data () {\n    return {\n      url: '',\n      overwrite: false\n    }\n  },\n  computed: {\n    ...mapState('db/bookmarks', ['bookmarks'])\n  },\n  methods: {\n    async importFromCloud () {\n      try {\n        const response = await fetch(this.url)\n        const bookmarks = await response.json()\n        this.importBookmarks(bookmarks)\n      } catch (error) {\n        this.$store.commit('alert', {\n          text: error,\n          type: 'error'\n        })\n      }\n    },\n    importFromFile (e) {\n      const file = e.target.files[0]\n      // Clear input to let it fire for the same file\n      e.target.value = null\n      const reader = new FileReader()\n      reader.onload = async e => {\n        const content = e.target.result\n        await this.importBookmarks(JSON.parse(content))\n      }\n      reader.readAsText(file)\n    },\n    async importBookmarks (bookmarks) {\n      if (!validate('/bookmarks', bookmarks)) {\n        this.$emit('input', false)\n        return\n      }\n      // https://stackoverflow.com/a/36744732/8810271\n      bookmarks = bookmarks.filter((m, index, self) =>\n        self.findIndex(t => bookmarkMatch(t, m)) === index\n      )\n\n      if (this.overwrite) {\n        bookmarks.forEach((b, i) => { b.index = i })\n        await this.$store.dispatch('clearAndAddAll', bookmarks)\n      } else {\n        bookmarks = bookmarks = bookmarks.filter(m =>\n          this.bookmarks.findIndex(t => bookmarkMatch(t, m)) === -1\n        )\n        bookmarks.forEach((b, i) => {\n          b.index = i + this.bookmarks.length\n        })\n        await this.$store.dispatch('addAll', bookmarks)\n      }\n\n      this.$store.commit('alert', {\n        text: this.$tc('message.import-success', bookmarks.length),\n        type: 'success'\n      })\n      this.$emit('input', false)\n    }\n  }\n}\n</script>\n\n<style></style>\n","import mod from \"-!../../.yarn/$$virtual/cache-loader-virtual-c1b5c548c1/0/cache/cache-loader-npm-4.1.0-82c3da90d8-2e369f72e3.zip/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../.yarn/$$virtual/thread-loader-virtual-c4f201d7e0/0/cache/thread-loader-npm-2.1.3-ed21f3c893-b607b8ae84.zip/node_modules/thread-loader/dist/cjs.js!../../.yarn/$$virtual/babel-loader-virtual-8667ef460d/0/cache/babel-loader-npm-8.2.2-b4e600c2c5-362bb71573.zip/node_modules/babel-loader/lib/index.js!../../.yarn/$$virtual/cache-loader-virtual-9f4b962941/0/cache/cache-loader-npm-4.1.0-82c3da90d8-2e369f72e3.zip/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../.yarn/$$virtual/vue-loader-virtual-7a338f5bf1/0/cache/vue-loader-npm-15.9.6-b3270576fe-30c649d779.zip/node_modules/vue-loader/lib/index.js??vue-loader-options!./ImportDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../.yarn/$$virtual/cache-loader-virtual-c1b5c548c1/0/cache/cache-loader-npm-4.1.0-82c3da90d8-2e369f72e3.zip/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../.yarn/$$virtual/thread-loader-virtual-c4f201d7e0/0/cache/thread-loader-npm-2.1.3-ed21f3c893-b607b8ae84.zip/node_modules/thread-loader/dist/cjs.js!../../.yarn/$$virtual/babel-loader-virtual-8667ef460d/0/cache/babel-loader-npm-8.2.2-b4e600c2c5-362bb71573.zip/node_modules/babel-loader/lib/index.js!../../.yarn/$$virtual/cache-loader-virtual-9f4b962941/0/cache/cache-loader-npm-4.1.0-82c3da90d8-2e369f72e3.zip/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../.yarn/$$virtual/vue-loader-virtual-7a338f5bf1/0/cache/vue-loader-npm-15.9.6-b3270576fe-30c649d779.zip/node_modules/vue-loader/lib/index.js??vue-loader-options!./ImportDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImportDialog.vue?vue&type=template&id=f0a65a50&\"\nimport script from \"./ImportDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./ImportDialog.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../.yarn/$$virtual/vue-loader-virtual-7a338f5bf1/0/cache/vue-loader-npm-15.9.6-b3270576fe-30c649d779.zip/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../.yarn/$$virtual/vuetify-loader-virtual-4007d172f1/0/cache/vuetify-loader-npm-1.7.2-d296a16f38-4e4fb2ed10.zip/node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCard,VCardText,VCol,VContainer,VDialog,VIcon,VRow,VSwitch,VTextField})\n"],"sourceRoot":""}